# sortClone

Учебный проект: реализация утилиты сортировки строк (аналог UNIX-утилиты `sort`) с поддержкой различных флагов и их комбинаций, поддержкой обработки больших файлов и интеграционными тестами.
На вход можно подавать как существующий файл, так и поток данных в StdIn.
!!!Приоритет типов: если строка не соответствует формату флага (например, не число при -n), она сортируется как обычная строка (string) и уходит в конец (или начало при -r).

## Возможности

Программа поддерживает:

- `-r` — сортировка в обратном порядке  
- `-n` — числовая сортировка  
- `-k <num>` — сортировка по указанному столбцу (нумерация с 0)  
- `-o <file>` — запись результата в указанный файл  
- `-u` — вывод только уникальных строк  
- `-b` — игнорировать хвостовые пробелы  
- `-d '<str>'` — использование указанного разделителя(delimeter), по умолчанию - табуляция
- `-c` — проверка отсортированности входных данных(игнорирует флаг -o при его наличии)  
- `-M` — сортировка по месяцам(парсит первые 3 символа строки и сравнивает с мапой месяцев)  
- `-H` — человекочитаемая сортировка (поддержка суффиксов T/Тб, Г/Гб, М/Мб, К/Кб кир./лат.)  
- `-h` — получение справочной информации о программе  


## Установка

```bash
git clone https://github.com/username/sortClone.git
cd sortClone
go build -o sortClone ./cmd
```

## Использование

### Обратная сортировка по числам и колонке с выводом уникальных значений в файл:

./sortClone -rnu input.txt -o result.txt -k 1

### Проверка отсортированности:

./sortClone -c input.txt

### Сортировка по месяцам
./sortClone -M months.txt

### Человекочитаемая сортировка по размеру
./sortClone -H sizes.txt

### Сортировка по третьей колонке с разделителем ","
./sortClone -k 2 -d "," csvfile.txt


## Тестирование

В проекте есть два набора тестов:

- **unit-тесты** (`/cmd`, `/reader`, `/sorter`, `/utils`)  
- **integration-тесты** (`/integration`)  

Запуск всех unit-тестов:

go test ./... -v

Запуск только интеграционных:

go test ./integration -tags=integrationtest -timeout 40s


## Структура проекта

sortClone/
├── cmd/              # Управляющий код утилиты и unit-тесты
├── integration/      # Интеграционные тесты
├── internal/         # Основной код сортировки и ее вспомогательные функции
    ├── heap/         # Реализация кучи, используемой при слиянии строк из временных файлов
    ├── model/        # Структуры данных и контейнер опций
    ├── reader/       # Функция-читатель - производит начальное чтение предоставленных данных для сортировки + unit-тесты
    ├── sorter/       # Основная логика сортировки + unit-тесты
    ├── utils/        # Вспомогательные функции для обеспечения сортировки согласно активным флагам + unit-тесты
├── go.mod
├── go.sum
├── main.go           # Точка входа в приложение сортировки
├── test.txt          # Файл для проведения ручных тестов, содержит 20 строк формата "Jan1111111111	2Kb"
├── smallfile.txt     # Файл для проведения ручных тестов, содержит 1000 строк формата "1000	VГВыRШxb	85847022	85847022тб"
├── task.md           # Описание изначальной задачи
└── README.md


## План доработки

- [ ] Добавить бенчмарки для больших файлов   
- [ ] Добавить больше интеграционных сценариев  
- [ ] Улучшить документацию примерами реальных входных/выходных файлов
- [ ] Доработать очистку данных после интеграционных тестов(удаление временных папок)
- [ ] Переделать логику генерации моковых файлов - сделать вызов из самих функций; разделить генерацию на small и big файлы
